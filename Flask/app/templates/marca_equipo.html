{% extends "layout.html" %}
{% block body %}
{% from 'funciones_macro.html' import paginacion %}

<div class="row">
    <div class="col-md-5 offset-md-3">


<!-- Botón para abrir el modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMarcaModal">
    Agregar Marca
</button>

<!-- Modal -->
<div class="modal fade" id="addMarcaModal" tabindex="-1" aria-labelledby="addMarcaModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addMarcaModalLabel">Agregar Marca</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="form_addMarcaModal" action="/add_marca_equipo" method="POST">
                    <div class="mb-3">
                        <label for="nombre_marca_equipo" class="form-label">Nombre Marca</label>
                        <input 
                            type="text" 
                            class="form-control campo-obligatorio" 
                            id="nombre_marca_equipo" 
                            name="nombre_marca_equipo" 
                            placeholder="Ingrese una Marca"
                        >
                        <span class="text-error-message text-danger" style="display: none;"></span>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="submit" form="form_addMarcaModal" class="btn btn-primary">Guardar</button>
            </div>
        </div>
    </div>
</div>



        <!-- Botón para mostrar el formulario -->
        <button class="nav-button" onclick="showDiv()">Agregar</button>

        <!-- Formulario -->
        <div class="card card-body" id="formulario" style="display: none;">
            <form id="marcaEquipoForm" action="/add_marca_equipo" method="POST" class="mi-formulario">
                <div class="form-group">
                    <label for="nombre_marca">Nombre Marca:</label>
                    <input
                        class="validatable-input"
                        type="text"
                        name="nombre_marca_equipo"
                        id="nombre_marca_equipo"
                        placeholder="Nombre marca"
                        maxlength="45"
                        required
                    >
                </div>
                <button type="submit" class="agregar-button">Agregar</button>
            </form>
        </div>
    </div>
</div>

<h2>Marca Equipos</h2>

<table id="posts">
    <thead>
        <tr>
            <td onclick="sortTable(0)">Nombre Marca</td>
            <td>Acciones</td>
        </tr>
    </thead>
    <tbody id="myTableBody">
        {% for marcae in marca_equipo %}
        <tr>
            <td>{{ marcae.nombreMarcaEquipo }}</td>
            <td>
                <a href="/marca_equipo/edit_marca_equipo/{{ marcae.idMarca_Equipo }}" class="success-button">Editar</a>
                <a href="/marca_equipo/delete_marca_equipo/{{ marcae.idMarca_Equipo }}" class="delete-button">Eliminar</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{{ paginacion("marca_equipo", page, lastpage) }}

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script src="../static/js/main.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
    // Manejo del submit del formulario del modal
    document.getElementById("form_addMarcaModal").addEventListener("submit", function (event) {
        let formularioValido = true;

        // Validar campos obligatorios
        const campo = document.getElementById("nombre_marca_equipo");
        const errorMessage = campo.nextElementSibling;

        if (campo.value.trim() === "") {
            errorMessage.textContent = "Este campo es obligatorio";
            errorMessage.style.display = "block";
            formularioValido = false;
        } else {
            errorMessage.style.display = "none";
        }

        // Si el formulario no es válido, prevenir el envío
        if (!formularioValido) {
            event.preventDefault();
        }
    });
});

</script>

{% endblock %}
